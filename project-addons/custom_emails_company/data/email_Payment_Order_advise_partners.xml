<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="payment_order_advise_partner_template">
        <html>
            <div>
                <p>
                    <t t-set="obj" t-value="email_template._context.get('obj')"/>
                    <t t-set="company" t-value="object and object.company_id or email_template._context.get('company')"/>
                </p>
                <table border="0" width="100%" cellpadding="0" style="padding: 20px; border-collapse:separate;" summary="o_mail_notification">
                    <tbody>
                        <tr>
                            <td align="center" style="min-width: 590px;">
                                <table width="590" border="0" cellpadding="0" style="min-width: 590px; padding: 20px; border-collapse:separate;">
                                    <tbody>
                                        <tr>
                                            <td valign="middle" style="color: #555; font-size: 14px;">
                                                <span t-field="obj.partner_id.name"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td valign="middle" style="color: #555; font-size: 14px;">
                                                <span>Dear Sir or Madam:</span>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td align="center" style="min-width: 590px;">
                                <table width="590" border="0" cellpadding="0" style="min-width: 590px; padding: 20px; border-collapse:separate;">
                                    <tbody>
                                        <tr>
                                            <td style="color: #555; font-size: 14px;">
                                                <p style="margin-bottom: 0cm; line-height: 14.95px; background-color: rgb(255, 255, 255);">
                                                    We would like to inform you that we have issued a direct debit receipt with the due date(s) corresponding to the invoice(s) detailed below:
                                                </p>
                                                <p style="line-height: 14.95px;"/>
                                                <div>
                                                    <br/>
                                                    <table width="516">
                                                        <tbody>
                                                          <table align="center" border="0" style="border-collapse:collapse; width:80%;">
                                                             <tr>
                                                               <td style="font-size: 11px; border: 1px solid black">Invoice number</td>
                                                               <td style="font-size: 11px; border: 1px solid black">Date</td>
                                                               <td style="font-size: 11px; border: 1px solid black">Amount</td>
                                                             </tr>
                                                            <tr t-foreach="obj.payment_line_ids" t-as="line" valign="middle">
                                                                <td style="border: 1px solid black">
                                                                    <p style="font-size: 11px;">
                                                                        <span t-field="line.communication"/>
                                                                    </p>
                                                                </td>
                                                                <td style="border: 1px solid black">
                                                                  <p style="font-size: 11px;">
                                                                        <span t-field="line.date"/>
                                                                    </p>
                                                                </td>
                                                                <td style="border: 1px solid black">
                                                                  <p style="font-size: 11px;">
                                                                        <span t-field="line.amount_currency"/>
                                                                    </p>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                              <td/>
                                                              <td style="text-align: right; font-size: 11px;">Total amount:  </td>
                                                              <td style="border: 1px solid black; font-size: 11px;" >
                                                                  <t t-set="total" t-value="sum(obj.payment_line_ids.mapped('amount_currency'))"/>
                                                                  <span t-esc="total" t-options="{&quot;widget&quot;: &quot;float&quot;, &quot;precision&quot;: 2}"/> â‚¬
                                                              </td>
                                                            </tr>
                                                          </table>
                                                        </tbody>
                                                         <tfoot>
                                                            <tr>
                                                                <td style="color: #555; font-size: 14px;">
                                                                  <br/>
                                                                  <p>The destination bank account is: <span t-esc="obj.partner_bank_id.acc_number[:2] + '** **** **** **** **** '+obj.partner_bank_id.acc_number[-4:]"/></p>
                                                                  <br/>
                                                                  <p>Yours sincerely.</p>
                                                                </td>
                                                            </tr>
                                                        </tfoot>
                                                    </table>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                        <!-- FOOTER -->
                        <tr>
                            <td align="center" style="min-width: 590px;">
                                <table align="center" width="590" border="0" cellpadding="0" bgcolor="#875A7B" style="min-width: 590px; background-color: rgb(135,90,123); padding: 20px; border-collapse:separate;">
                                    <tr>
                                        <td valign="middle" align="left" style="color: #fff; padding-top: 10px; padding-bottom: 10px; font-size: 12px;">
                                            <span t-field="company.name"/>
                                            <br/>
                                            <span t-field="company.phone"/>
                                        </td>
                                        <td valign="middle" align="right" style="color: #fff; padding-top: 10px; padding-bottom: 10px; font-size: 12px;">
                                            <t t-if="company.email">
                                                <a t-att-href="'mailto:' + company.email" style="text-decoration:none; color: white;">
                                                    <span t-field="company.email"/>
                                                </a>
                                                <br/>
                                            </t>
                                            <t t-if="company.website">
                                                <a t-att-href="company.website" style="text-decoration:none; color: white;">
                                                    <span t-field="company.website"/>
                                                </a>
                                            </t>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p/>
                <style type="text/css">@page { size: 21cm 29.7cm; margin: 2cm }
                p { margin-bottom: 0.25cm; direction: ltr; line-height: 115%; text-align: left; orphans: 2; widows: 2; background: transparent }
                a:link { color: #000080; so-language: zxx; text-decoration: underline }
                a:visited { color: #800000; so-language: zxx; text-decoration: underline }</style>
                <style type="text/css">@page { size: 21cm 29.7cm; margin: 2cm }
                p { margin-bottom: 0.25cm; direction: ltr; line-height: 115%; text-align: left; orphans: 2; widows: 2; background: transparent }
                a:link { color: #000080; so-language: zxx; text-decoration: underline }
                a:visited { color: #800000; so-language: zxx; text-decoration: underline }</style>
                <style type="text/css">@page { size: 21cm 29.7cm; margin: 2cm }
                p { margin-bottom: 0.25cm; direction: ltr; line-height: 115%; text-align: left; orphans: 2; widows: 2; background: transparent }
                a:link { color: #000080; so-language: zxx; text-decoration: underline }
                a:visited { color: #800000; so-language: zxx; text-decoration: underline }</style>
            </div>
        </html>
    </template>

    <record id="account_banking_sepa_mail.payment_order_advise_partner" model="mail.template">
        <field name="name"> Payment Order advise partners 11 </field>
        <field name="email_from">${'contabilidad@visiotechsecurity.com'}</field>
        <field name="email_to">${ctx.get('partner_email2') or ctx.get('partner_email') or ''}</field>
        <field name="partner_to"></field>
        <field name="subject">Aviso de recibo</field>
        <field name="reply_to">${(ctx.get('partner_team').name == 'Italia' and 'contabilita@visiotechsecurity.com') or (ctx.get('partner_team').name == 'Francia' and 'comptabilite@visiotechsecurity.com') or (ctx.get('partner_team').name == 'Portugal' and 'contabilidade@visiotechsecurity.com') or 'contabilidad@visiotechsecurity.com'}</field>
        <field name="model_id" ref="account_payment_order.model_account_payment_order"/>
        <field name="auto_delete" eval="False"/>
        <field name="body_type">qweb</field>
        <field name="body_view_id" ref="payment_order_advise_partner_template" />
    </record>

</odoo>
